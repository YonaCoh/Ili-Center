questions = [
    {
        category: "Body",
        idNumber: 0,
        question: "עד כמה חשוב לך להתמיד מידי יום בפעילות גופנית?",
        openInput: false
    },
    {
        category: "Body",
        idNumber: 1,
        question: "עד כמה נוכחים סיגריות, אלכוהול או סמים בחיים שלך נכון להיום?",
        openInput: false
    },
    {
        category: "Body",
        idNumber: 2,
        question: "עד כמה חשוב, לדעתך, לבדוק את מדדי הדם שלך בכל כמה חודשים?",
        openInput: false
    },
    {
        category: "Body",
        idNumber: 3,
        question: "כמה שעות בממוצע אני נוטה לישון בלילה?",
        openInput: false
    },
    {
        category: "Body",
        idNumber: 4,
        question: "עד כמה אני חש/ה כאב ביום יום בתנועה שלי?",
        openInput: false
    },
    {
        category: "Body",
        idNumber: 5,
        question: "עד כמה אני מרגיש/ה שהגיל הביולוגי שלי תואם לגיל הגופני שלי? (גיל מטבולי מול גיל ביולוגי)",
        openInput: false
    },
    {
        category: "Body",
        idNumber: 6,
        question: "עד כמה אני מודע/ת לתפקידם וחשיבותם של שרירי הליבה?",
        openInput: false
    },
    {
        category: "Body",
        idNumber: 7,
        question: "עד כמה אני קשוב/ה לצרכים של הגוף שלי נכון להיום?",
        openInput: false
    },
    {
        category: "Body",
        idNumber: 8,
        question: "האם את/ה מסוגל/ת לבצע מתח ואם כן אז כמה חזרות רצוף ?",
        openInput: false
    },
    {
        category: "Body",
        idNumber: 9,
        question: "עד כמה, לדעתי, הגוף שלי גמיש נכון להיום ? (יכולת לבצע דיפ סקוואט, גשר, שפאגט, קיפול)?",
        openInput: false
    },
    {
        category: "Nutrition",
        idNumber: 0,
        question: "עד כמה אני מרגיש/ה שיש לי ידע רחב לגבי תזונה נכון להיום?",
        openInput: false
    },
    {
        category: "Nutrition",
        idNumber: 1,
        question: "עד כמה אני מקפיד/ה על שתיית מים ביום יום שלי?",
        openInput: false
    },
    {
        category: "Nutrition",
        idNumber: 2,
        question: "עד כמה חשוב לי להימנע מצריכת סוכר מעובד או סוכר לבן?",
        openInput: false
        ,
    },
    {
        category: "Nutrition",
        idNumber: 3,
        question: "עד כמה חשוב לי לצרוך מזונות שקרובים לטבע?",
        openInput: false
        ,
    },
    {
        category: "Nutrition",
        idNumber: 4,
        question: "אני נוטה להפסיק לאכול ברגע שאני חש/ה שובע?",
        openInput: false
        ,
    },
    {
        category: "Nutrition",
        idNumber: 5,
        question: "עד כמה אני מרגיש/ה שהאכילה שלי היא אכילה רגשית?",
        openInput: false
        ,
    },
    {
        category: "Nutrition",
        idNumber: 6,
        question: "עד כמה חשוב לי שהמזון שאני מכניס/ה לגוף ימנע מחלות עתידיות שיכולות להיגרם לי?",
        openInput: false
        ,
    },
    {
        category: "Nutrition",
        idNumber: 7,
        question: 'אני מרגיש/ה שאני אוכל/ת "אכילה מודעת" (יש לי את היכולת להסתכל על האוכל ממקום מודע ולא הישרדותי)',
        openInput: false
        ,
    },
    {
        category: "Community",
        idNumber: 0,
        question: "עד כמה אני מגדיר/ה את עצמי כיום כאדם חברתי?",
        openInput: false
        ,
    },
    {
        category: "Community",
        idNumber: 1,
        question: 'עד כמה אני מרגיש/ה חלק מ"קהילה" בחיים שלי כיום?',
        openInput: false
        ,
    },
    {
        category: "Community",
        idNumber: 2,
        question: "עד כמה אני מגדיר/ה את עצמי כאדם שיודע לפעול בקבוצה כיום?",
        openInput: false
        ,
    },
    {
        category: "Community",
        idNumber: 3,
        question: "עד כמה הפעולות שלי היום מקדמות את הסביבה שלי?",
        openInput: false
        ,
    },
    {
        category: "Community",
        idNumber: 4,
        question: "אני נוטה לרצות את הקבוצה ולא להיות נאמן לעקרונות שלי (כל קבוצה חברתית)",
        openInput: false
        ,
    },
    {
        category: "Community",
        idNumber: 5,
        question: "עד כמה אני פתוח/ה ללמוד דברים מהסביבה שלי כיום?",
        openInput: false
        ,
    },
    {
        category: "Community",
        idNumber: 6,
        question: "עד כמה אני תופס/ת עצמי כמנהיג/ה בתוך הסביבה שלי כיום?",
        openInput: false
        ,
    },
    {
        category: "Community",
        idNumber: 7,
        question: 'עד כמה הסביבה שלי תורמת לרמת האושר שלי כיום?',
        openInput: false
        ,
    },
    {
        category: "Community",
        idNumber: 8,
        question: 'עד כמה אני נוטה לשתף את הסביבה שלי ברגשות שלי ובחיים שלי כיום?',
        openInput: false
        ,
    },
    {
        category: "Values",
        idNumber: 0,
        question: "עד כמה אני תופס/ת את עצמי כאדם שמונע מהצורך בבריאות הגוף והנפש?",
        openInput: false
        ,
    },
    {
        category: "Values",
        idNumber: 1,
        question: 'עד כמה אורח חיים בריא מעניק לי היום תחושת ביטחון?',
        openInput: false
        ,
    },
    {
        category: "Values",
        idNumber: 2,
        question: "עד כמה אני גמיש/ה בראייה שלי את המציאות ואת אפשרויות הבחירה שלי בעולם? (גמישות מחשבתית)",
        openInput: false
        ,
    },
    {
        category: "Values",
        idNumber: 3,
        question: "אני נוטה לשתף אנשים ברגשות שלי",
        openInput: false
        ,
    },
    {
        category: "Values",
        idNumber: 4,
        question: "עד כמה אני מצליח/ה להשיג את המטרות שאני מציב לעצמי היום?",
        openInput: false
        ,
    },
    {
        category: "Values",
        idNumber: 5,
        question: "עד כמה אני מעריך/ה את עצמי היום? (עם כל מה שאני יודע/ת על עצמי כרגע)?",
        openInput: false
        ,
    },
    {
        category: "Values",
        idNumber: 6,
        question: "עד כמה אני מרגיש/ה שאני מממש/ת את היכולות שלי נכון להיום?",
        openInput: false
        ,
    },
    {
        category: "Values",
        idNumber: 7,
        question: 'אני נוטה לחוש חמלה כלפי כל מה שקיים ומתרחש סביבי?',
        openInput: false
        ,
    },
    {
        category: "Spirit",
        idNumber: 0,
        question: "עד כמה אני תופס/ת עצמי כאדם מדיטטיבי? (תודעה שלווה, חשיבה בהירה ואיזון נפשי)",
        openInput: false
        ,
    },
    {
        category: "Spirit",
        idNumber: 1,
        question: 'עד כמה אני מצליח/ה לתקשר בחיים שלי עם תת המודע שלי? (החלקים בי שמניעים אותי בחיים ואינני מודע/ת אליהם)',
        openInput: false
        ,
    },
    {
        category: "Spirit",
        idNumber: 2,
        question: "עד כמה אני תופס/ת עצמי כבעל/ת דימיון עשיר?",
        openInput: false
        ,
    },
    {
        category: "Spirit",
        idNumber: 3,
        question: "עד כמה אני קשוב/ה לאינטואיציה שלי? (חשיבה על פי תחושת בטן)",
        openInput: false
        ,
    },
    {
        category: "Spirit",
        idNumber: 4,
        question: "עד כמה אני מרגיש/ה מחובר/ת לנשמה שלי?",
        openInput: false
        ,
    },
    {
        category: "Spirit",
        idNumber: 5,
        question: "עד כמה אני מרגיש/ה מחובר/ת לייעוד שלי בחיים? (התכלית לשמה הגעתי לעולם)",
        openInput: false
        ,
    },
    {
        category: "Spirit",
        idNumber: 6,
        question: "עד כמה אני תופס/ת עצמי כאדם שיודע/ת לנהל את הרגשות שלי?",
        openInput: false
        ,
    },
    {
        category: "Spirit",
        idNumber: 7,
        question: 'עד כמה אני מודע/ת בחיים שלי לשיעורים שאני עובר/ת מידי יום? (אתגרים)',
        openInput: false
        ,
    },
    {
        category: "Spirit",
        idNumber: 8,
        question: 'עד כמה אני מרגיש/ה שאני מונע/ת ביום יום שלי מאהבה? (תחושה פנימית נטולת אינטרס ופחד)',
        openInput: false
        ,
    },
    {
        category: "Spirit",
        idNumber: 9,
        question: 'עד כמה אני מרגיש/ה שיש לי יכולת לראות מעבר למה שהפיזי מאפשר לי?',
        openInput: false
        ,
    },
    {
        category: "Identity",
        idNumber: 0,
        question: "כשאני חושב/ת על עצמי במצב מיטבי של עצמי, אני אומר/ת על עצמי שאני ...",
        openInput: true
        ,
    },
    {
        category: "Identity",
        idNumber: 1,
        question: 'מהם הדברים שאני עושה/ אומר/ת חושב/ת שקובעים שאני ________?',
        openInput: true
        ,
    },
    {
        category: "Identity",
        idNumber: 2,
        question: "עד כמה אתה מרגיש/ה נכון להיום שאת/ה _____ לפחות 80% מהזמן שלך?",
        openInput: false
        ,
    },
    {
        category: "Identity",
        idNumber: 3,
        question: "עד כמה אני פועל/ת ביום יום שלי, נכון להיום, כדי להיות ______?",
        openInput: false
        ,
    },
    {
        category: "Identity",
        idNumber: 4,
        question: "עד כמה אני מרגיש/ה שאני צריך/ה לוותר על דברים אחרים שחשובים לי כדי להיות _____?",
        openInput: false
        ,
    },
    {
        category: "Identity",
        idNumber: 5,
        question: "עד כמה אני מרגיש/ה שהסביבה שלי מאפשרת לי להיות _____?",
        openInput: false
        ,
    },
    {
        category: "Identity",
        idNumber: 6,
        question: "עד כמה אני מרגיש/ה שיש לי את כל המיומנויות שאני צריך/ה כדי להיות ____ ?",
        openInput: false
        ,
    },
    {
        category: "Identity",
        idNumber: 7,
        question: 'עד כמה אני מרגיש/ה שהאמונות שלי על עצמי ועל העולם משרתות את התפיסה שלי שאני _________?',
        openInput: false
        ,
    },
    {
        category: "Identity",
        idNumber: 8,
        question: 'עד כמה אני מרגיש/ה שההתנהגות שלי ביום יום משרתת את התפיסה שלי שאני __________?',
        openInput: false
        ,
    },
    {
        category: "Identity",
        idNumber: 9,
        question: 'עד כמה חשוב לי להיות __________ לחלוטין?',
        openInput: false
        ,
    },
]


// ---------- LINEAR RADIO ---------------

/* <div class="form-check form-check-inline">
<input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="option1">
<label class="form-check-label" for="inlineRadio1">1</label>
</div>
<div class="form-check form-check-inline">
<input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="option2">
<label class="form-check-label" for="inlineRadio2">2</label>
</div>
<div class="form-check form-check-inline">
<input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio3" value="option3" disabled>
<label class="form-check-label" for="inlineRadio3">3 (disabled)</label>
</div> */

function Trainee(_name, _questions, _category, _isbbq) {
    this.name = _name;
    this.questions = _questions
    this.category = _category
    this.isBBQ = _isbbq
};

let state = [];

let nameOfCurTrainee;

const gradesForEachQuestion = [];

function QuestionObject(_category, _id, _grade) {
    this.category = _category;
    this.id = _id;
    this.grade = _grade;
}

function addName() {
    if (!document.querySelector('#addNameInput').value) {
        alert("Please enter a valid name")
        return
    }
    document.querySelector('#initialScreen').style.display = "none";

    nameOfCurTrainee = document.querySelector('#addNameInput').value;
    document.querySelector("#title").innerHTML = `הזנת נתונים עבור ${nameOfCurTrainee}`;
    createForm();
}


function init() {
    if (!localStorage.getItem('questions')) {
        window.localStorage.setItem('questions', JSON.stringify(questions));
    }

    if (localStorage.getItem('data')) {
        let tempState = JSON.parse(window.localStorage.getItem('data'));
        state = Object.values(tempState)
    }

    document.querySelector('#addNameBtn').addEventListener("click", addName);
}

function createForm() {
    for (question of questions) {
        const curElem = document.createElement("div");
        // curElem.class = "row";
        curElem.className = "form"
        if (!question.openInput) {
            curElem.innerHTML = `
            <hr>
                <div class="mb-3">
                    <h2">${question.category} קטגוריה</h2>
                </div>
                <div class="mb-3">
                <div dir="rtl">${question.idNumber + 1}. ${question.question}</div>
                </div>
                <input type="number" class="questionSection" id="${question.category}-${question.idNumber}" min="1" max="10">
            <div class="row">
                </div>
        `
        } else {
            curElem.innerHTML = `
            <hr>
                <div class="mb-3">
                    <h2">${question.category} קטגוריה</h2>
                </div>
                <div class="mb-3">
                    <div dir="rtl">${question.idNumber + 1}. ${question.question}</div>
                    <input type="number" class="questionSection" id="${question.category}-${question.idNumber}" min="1" max="10">
                </div>
            </div>
            <div class="row">
                <div class="mb-3">
                    <textArea id="${question.category}${question.idNumber}OpenText"></textArea>
                </div>
                <div class="input-number mb-3">
</div>`
        }
        document.querySelector("#form-container").append(curElem);
    }
    const submitBtn = document.createElement("button");
    submitBtn.id = "submit-btn"
    submitBtn.className = "btn btn-primary"
    submitBtn.innerHTML = "לסיום לחץ כאן"

    document.querySelector('#form-container').append(document.createElement("hr"));
    document.querySelector('#form-container').append(submitBtn);

    document.querySelector("#submit-btn").addEventListener('click', submitData);
}


function submitData() {

    const arrayOfElements = document.querySelectorAll(".questionSection");
    const arrayOfQuestions = [];
    let sumGrades = 0;
    let amountGrades = 0;
    let curCategory;
    let formerCatgory;
    let isBBQ = false;

    const categoryObject = {}

    for (elem of arrayOfElements) {
        if (!elem.value) {
            alert(`(${elem.id}) נא למלא הכל נבלה`)
            return
        }
        if (elem.value <= 0 || elem.value >= 11) {
            alert(`(${elem.id} - ציון ${elem.value}) מה זה הציון הזה השתגענו??`)
            return
        }
        const data = elem.id.split("-");
        curCategory = data[0];
        const curQuestion = new QuestionObject(curCategory, data[1], elem.value);
        arrayOfQuestions.push(curQuestion);

        // IMPLEMENT AVERAGE CALCULATION FOR EACH CATEGORY!!!!

        if (!formerCatgory) {
            formerCatgory = curCategory;
        }
        if (curCategory === formerCatgory) {
            sumGrades += parseInt(elem.value);
            amountGrades++;
        } else {
            categoryObject[formerCatgory] = Math.floor(sumGrades / amountGrades);
            if (categoryObject[formerCatgory] <= 6) {
                isBBQ = true;
            }
            amountGrades = 0;
            sumGrades = parseInt(elem.value);
            formerCatgory = curCategory;
        }
    }
    categoryObject[curCategory] = Math.floor(sumGrades / amountGrades);
    console.log(categoryObject)
    const curTrainee = new Trainee(nameOfCurTrainee, arrayOfQuestions, categoryObject, isBBQ)
    state.push(curTrainee)
    clearForm()
    alert(`${nameOfCurTrainee} נרשם.ה!`)
    editLocalStorage(state);
}


function editLocalStorage(data) {
    window.localStorage.setItem('data', JSON.stringify(data));

}

function clearForm() {

    document.querySelector("#title").innerHTML = `הזנת נתונים`
    document.querySelector('#form-container').innerHTML = "";
    document.querySelector('#initialScreen').style.display = "block";
}

init()


//--------------------------RADIO-----------------------------
// <div class="input-number mb-3">
// <div class="form-check form-check-inline">
// <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="option1">
// <label class="form-check-label" for="inlineRadio1">1</label>
// </div>
// <div class="form-check form-check-inline">
// <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="option2">
// <label class="form-check-label" for="inlineRadio2">2</label>
// </div>
// <div class="form-check form-check-inline">
// <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio3" value="option3">
// <label class="form-check-label" for="inlineRadio3">3</label>
// </div>
// <div class="form-check form-check-inline">
// <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio4" value="option4">
// <label class="form-check-label" for="inlineRadio4">4</label>
// </div>
// <div class="form-check form-check-inline">
// <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio5" value="option5">
// <label class="form-check-label" for="inlineRadio5">5</label>
// </div>
// <div class="form-check form-check-inline">
// <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio6" value="option6">
// <label class="form-check-label" for="inlineRadio6">6</label>
// </div>
// <div class="form-check form-check-inline">
// <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio7" value="option7">
// <label class="form-check-label" for="inlineRadio7">7</label>
// </div>
// <div class="form-check form-check-inline">
// <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio8" value="option8">
// <label class="form-check-label" for="inlineRadio8">8</label>
// </div>
// <div class="form-check form-check-inline">
// <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio9" value="option9">
// <label class="form-check-label" for="inlineRadio9">9</label>
// </div>
// <div class="form-check form-check-inline">
// <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio10" value="option10">
// <label class="form-check-label" for="inlineRadio10">10</label>
// </div>